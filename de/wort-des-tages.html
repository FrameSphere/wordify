<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wort des Tages ‚Äì T√§gliches Wortr√§tsel | Wordify</title>
    <meta name="description" content="Das t√§gliche Wort des Tages R√§tsel auf Wordify. Jeden Tag ein neues deutsches 5-Buchstaben-Wort f√ºr alle Spieler ‚Äì errate es in 6 Versuchen!">
    <link rel="canonical" href="https://wordify.pages.dev/de/wort-des-tages.html">
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3654554314003005" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../style.css">
    <style>
        /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
        body { align-items: flex-start; }
        .wdt-wrap { max-width: 480px; width: 100%; margin: 0 auto; padding: 16px 12px 60px; display: flex; flex-direction: column; align-items: center; }

        /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
        .wdt-header { width: 100%; text-align: center; padding-bottom: 14px; border-bottom: 2px solid var(--border-color); margin-bottom: 16px; }
        .back-link { display: inline-flex; align-items: center; gap: 5px; color: var(--accent-primary); text-decoration: none; font-size: 0.85rem; font-weight: 600; margin-bottom: 10px; }
        .back-link:hover { color: var(--accent-hover); }
        .wdt-logo { font-size: 1.3rem; font-weight: 800; color: var(--accent-primary); margin-bottom: 4px; }
        .wdt-logo span { background: var(--accent-primary); color: white; border-radius: 6px; padding: 1px 7px; margin-right: 5px; }
        .wdt-title { font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin-bottom: 4px; }
        .wdt-subtitle { font-size: 0.9rem; color: var(--text-secondary); }
        .wdt-date { display: inline-block; margin-top: 6px; font-size: 0.8rem; font-weight: 700; color: var(--accent-primary); background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 20px; padding: 3px 12px; }
        .countdown-wrap { margin-top: 8px; font-size: 0.8rem; color: var(--text-secondary); }
        .countdown-wrap span { font-weight: 700; color: var(--text-primary); font-variant-numeric: tabular-nums; }

        /* ‚îÄ‚îÄ Board ‚îÄ‚îÄ */
        .wdt-board { display: grid; grid-template-rows: repeat(6, 1fr); gap: 5px; margin: 12px 0; }
        .wdt-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; }
        .wdt-cell {
            width: 58px; height: 58px; border: 2px solid var(--border-color);
            border-radius: 6px; display: flex; align-items: center; justify-content: center;
            font-size: 1.6rem; font-weight: 800; text-transform: uppercase;
            color: var(--text-primary); background: var(--bg-primary);
            transition: border-color 0.1s; user-select: none;
        }
        .wdt-cell.filled { border-color: var(--text-secondary); animation: pop .08s ease; }
        .wdt-cell.correct { background: var(--correct); border-color: var(--correct); color: white; }
        .wdt-cell.present { background: var(--present); border-color: var(--present); color: white; }
        .wdt-cell.absent  { background: var(--absent);  border-color: var(--absent);  color: white; }
        .wdt-cell.revealed { animation: flip .35s ease forwards; }
        @keyframes pop { 0%,100%{transform:scale(1)} 50%{transform:scale(1.12)} }
        @keyframes flip { 0%{transform:rotateX(0)} 50%{transform:rotateX(-90deg)} 100%{transform:rotateX(0)} }
        .wdt-shake { animation: shake .4s ease; }
        @keyframes shake { 0%,100%{transform:translateX(0)} 20%,60%{transform:translateX(-6px)} 40%,80%{transform:translateX(6px)} }

        /* ‚îÄ‚îÄ Message ‚îÄ‚îÄ */
        .wdt-message { min-height: 28px; text-align: center; font-weight: 700; font-size: 0.95rem; color: var(--accent-primary); margin-bottom: 4px; }

        /* ‚îÄ‚îÄ Keyboard ‚îÄ‚îÄ */
        .wdt-keyboard { display: flex; flex-direction: column; gap: 6px; width: 100%; max-width: 460px; }
        .wdt-key-row { display: flex; justify-content: center; gap: 5px; }
        .wdt-key {
            height: 56px; min-width: 34px; padding: 0 6px; border-radius: 6px;
            background: var(--key-bg, #818384); color: white; font-weight: 700;
            font-size: 0.8rem; border: none; cursor: pointer; flex: 1; max-width: 42px;
            display: flex; align-items: center; justify-content: center; transition: background 0.2s;
            text-transform: uppercase; user-select: none;
        }
        .wdt-key.wide { max-width: 66px; font-size: 0.72rem; flex: 1.5; }
        .wdt-key.correct { background: var(--correct) !important; }
        .wdt-key.present { background: var(--present) !important; }
        .wdt-key.absent  { background: var(--absent)  !important; }

        /* ‚îÄ‚îÄ Modal ‚îÄ‚îÄ */
        .wdt-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.5); display: none; align-items: center; justify-content: center; z-index: 100; padding: 16px; }
        .wdt-modal-overlay.active { display: flex; }
        .wdt-modal { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 20px; padding: 32px 28px; max-width: 360px; width: 100%; text-align: center; animation: fadeUp .25s ease; }
        @keyframes fadeUp { from{transform:translateY(20px);opacity:0} to{transform:translateY(0);opacity:1} }
        .wdt-modal-icon { font-size: 3rem; margin-bottom: 10px; }
        .wdt-modal-title { font-size: 1.4rem; font-weight: 800; color: var(--text-primary); margin-bottom: 6px; }
        .wdt-modal-word { font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 16px; }
        .wdt-modal-word strong { color: var(--accent-primary); font-size: 1.4rem; letter-spacing: 0.08em; }
        .wdt-modal-stats { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .wdt-modal-stat { text-align: center; }
        .wdt-modal-stat .val { font-size: 1.6rem; font-weight: 800; color: var(--text-primary); }
        .wdt-modal-stat .lbl { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }
        .wdt-modal-result { background: var(--bg-secondary); border-radius: 10px; padding: 12px; margin-bottom: 18px; font-size: 1.4rem; letter-spacing: 3px; line-height: 1.6; }
        .wdt-modal-next { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 20px; }
        .wdt-modal-next strong { color: var(--text-primary); font-variant-numeric: tabular-nums; }
        .wdt-btn-row { display: flex; flex-direction: column; gap: 10px; }
        .wdt-btn { padding: 12px 24px; border-radius: 12px; font-weight: 700; font-size: 0.95rem; cursor: pointer; border: none; transition: transform 0.15s, box-shadow 0.15s; }
        .wdt-btn:hover { transform: translateY(-2px); }
        .wdt-btn-share { background: var(--accent-primary); color: white; box-shadow: 0 2px 8px rgba(99,102,241,.35); }
        .wdt-btn-home  { background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); }
        .wdt-btn-retry { background: #f59e0b; color: white; }

        /* ‚îÄ‚îÄ Already played banner ‚îÄ‚îÄ */
        .wdt-played-banner { background: var(--bg-secondary); border: 1px solid var(--border-color); border-left: 4px solid var(--accent-primary); border-radius: 10px; padding: 14px 18px; margin: 12px 0; text-align: center; }
        .wdt-played-banner p { color: var(--text-secondary); font-size: 0.9rem; margin: 0; }
        .wdt-played-banner strong { color: var(--text-primary); }

        /* ‚îÄ‚îÄ Theme toggle ‚îÄ‚îÄ */
        .wdt-topbar { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 4px; }
        .wdt-theme-btn { background: none; border: 1px solid var(--border-color); border-radius: 8px; padding: 6px 10px; cursor: pointer; color: var(--text-secondary); font-size: 1rem; }

        @media(max-width:380px){
            .wdt-cell { width: 52px; height: 52px; font-size: 1.4rem; }
            .wdt-key { height: 48px; }
        }
    </style>
</head>
<body>
<div class="wdt-wrap">

    <!-- Topbar -->
    <div class="wdt-topbar">
        <a href="/de/" class="back-link">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
            Zur√ºck
        </a>
        <button class="wdt-theme-btn" onclick="toggleTheme()" title="Theme wechseln">üåô</button>
    </div>

    <!-- Header -->
    <div class="wdt-header">
        <div class="wdt-logo"><span>W</span> Wordify</div>
        <div class="wdt-title">üóìÔ∏è Wort des Tages</div>
        <div class="wdt-subtitle">Ein Wort f√ºr alle ‚Äì t√§glich neu um Mitternacht</div>
        <div class="wdt-date" id="todayDate"></div>
        <div class="countdown-wrap">N√§chstes Wort in <span id="countdown">--:--:--</span></div>
    </div>

    <!-- Message -->
    <div class="wdt-message" id="message"></div>

    <!-- Board -->
    <div class="wdt-board" id="board"></div>

    <!-- Keyboard -->
    <div class="wdt-keyboard" id="keyboard"></div>

</div>

<!-- Win / Lose Modal -->
<div class="wdt-modal-overlay" id="modal">
    <div class="wdt-modal">
        <div class="wdt-modal-icon" id="modalIcon"></div>
        <div class="wdt-modal-title" id="modalTitle"></div>
        <div class="wdt-modal-word" id="modalWord"></div>
        <div class="wdt-modal-stats" id="modalStats"></div>
        <div class="wdt-modal-result" id="modalResult"></div>
        <div class="wdt-modal-next" id="modalNext"></div>
        <div class="wdt-btn-row" id="modalBtns"></div>
    </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WORTLISTE ‚Äì Wort des Tages (kuratierte 365+ deutsche 5-Buchstaben-W√∂rter)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DAILY_WORDS = [
    "ABEND","ADLER","ALTAR","AMPEL","ANGEL","ANGST","ANKER","APFEL","ARBOR","ARCHE",
    "ARMEL","ASSEL","ATLAS","ATMEN","AUTOS","AXTHI","AZURE","BACKE","BAKEN","BALKE",
    "BALLE","BALON","BAUCH","BAUEN","BAUMS","BEERE","BESEN","BETON","BIRKE","BISON",
    "BLATT","BLICK","BLITZ","BLOCK","BLUME","BODEN","BOHNE","BOMBE","BRAUT","BRAUN",
    "BREIT","BRIEF","BRUCH","BR√úCKE","BUCHT","BULLE","BUSCH","CREME","DACHS","DAMPF",
    "DECKE","DELTA","DIELE","DOLCH","DONAU","DRUCK","DUELL","DUNST","DURCH","EBENE",
    "EIMER","EINIG","EISEN","ENGEL","ENTEN","ERNTE","ERSTE","ESCHE","ESSEL","EUTER",
    "FADEN","FAHNE","FALKE","FARBE","FAUST","FEDER","FEIGE","FEIND","FERNE","FEUER",
    "FIBER","FISCH","FLACH","FLAGGE","FLAMM","FLECK","FLIEH","FLOSS","FLOTT","FLUCH",
    "FLUSS","FORST","FOTZE","FRECH","FREIT","FREMD","FRIEDEN","FRONT","FUCHS","FUNKE",
    "GABEL","GASSE","GATTE","GEBER","GEIST","GELBE","GEMSE","GER√ÑT","GER√úST","GLANZ",
    "GLAUB","GLEICH","GLEIS","GL√úCK","GNADE","GOLDE","GRIFF","GRUBE","GRUND","GRUPPE",
    "GUAVE","HALTE","HAMME","HASEL","HECHT","HERDE","HEROE","HERZE","HIRTE","HITZE",
    "HOBEL","H√úGEL","HUMOR","HUNDS","H√úTTE","IGELN","IMMER","INSEL","IRREN","JAGD",
    "JAHRE","JOKER","JUBEL","JUNGE","KAMEL","KAPPE","KARTE","KATZE","KEGEL","KEILE",
    "KETTE","KIPPE","KIRME","KISTE","KLAGE","KLAMM","KLANG","KLARE","KNALL","KNAPP",
    "KNAUR","KNICK","KNIFF","KNOPF","KOHLE","KRAFT","KREIS","KREUZ","KRISE","KRONE",
    "KRUME","K√úCHE","LACHS","LADEN","LAKEN","LAMPE","LAUBE","LAUCH","LAUNE","LAUTE",
    "LEHRE","LEISE","LICHT","LIEBE","LINSE","L√ñFFEL","LOKAL","L√úCKE","LUDER","LUNTE",
    "MAGIE","MAHLE","MALER","M√ÑHNE","MARKT","MASKE","MASSE","MAUER","MAUSE","MEILE",
    "MEISE","MEUTE","MITTE","M√ñBEL","MONAT","MORGE","MOTIV","MOTTE","MULDE","M√úNZE",
    "NACHT","NADEL","N√ÑHTE","NERV","NETZ","NEUES","NIETE","NIXE","NOBLE","NONNE",
    "NORMA","NOTIZ","NUDEL","NUTEN","OASIS","OCKER","√ñFFNE","OHRNE","OLIVE","OPFER",
    "ORDEN","OSKAR","PALME","PANEL","PAUSE","PERLE","PFERD","PFEIL","PFIFF","PHASE",
    "PIRAT","PIXEL","PLAGE","PLANE","PLATZ","PLUMP","POLAR","POKAL","POLKA","PREIS",
    "PROBE","PROFI","PSALM","PUMPE","PUPPE","QUARZ","QUEUE","RABEN","RANCH","RASTE",
    "RATTE","RAUCH","RAUPE","RECHE","REGEN","REICH","REISE","RENNT","RESTE","RICHTIG",
    "RINDE","RINGE","RISPE","RITTER","ROBBEN","ROSEN","ROSTE","ROTTE","RUDEL","RUDER",
    "SAHNE","SALZE","SAMEN","SANFT","SATIN","SCHAF","SCHAU","SCHAL","SCHAR","SCHAU",
    "SCHEU","SCHIF","SCHLAF","SCHLAU","SCHMAL","SCHNEE","SCH√ñN","SCHUH","SEELE","SEGEL",
    "SEIFE","SEITE","SIRUP","SONNE","SORGE","SPALT","SPANN","SPATZ","SPECK","SPEER",
    "SPEIS","SPIEL","SPING","SPORT","STERN","STICH","STILL","STOCK","STORM","STROH",
    "STURM","SUCHE","SUCHT","TANNE","TAUBE","TEGEL","TEICH","TEIGE","TINTE","TISCH",
    "TITEL","TOBAK","TOLLE","TONNE","TORTE","TRAUM","TRECK","TREIB","TREFF","TRIFT",
    "TROLL","TROTZ","TR√úBE","TULPE","ULTRA","UMWEG","UNGEL","UNION","UNRAT","URTEIL",
    "VATER","VINYL","VISUM","VOGEL","VOLKS","WACHS","WAGEN","WAGEN","WAHRE","WAISE",
    "W√ÑLZE","WANGE","WARTE","WEDEL","WEHNE","WEIDE","WELLE","WENIG","WIEGE","WIESE",
    "WOLKE","WONNE","WURZE","ZANGE","ZIEGE","ZOPFE","ZWECK","ZWEIG","ZWERG","ZWICK",
    "AHORN","AMSEL","ASTER","BEULE","BIRNE","BORKE","BUCHE","DOLDE","DROSSEL","EICHE",
    "ENZYM","ERLEN","FALBE","FARNE","FASAN","FERKE","FLINT","FORKE","FROST","G√ÑSTE",
    "GENUG","GILET","GIPFEL","GLIED","GLIMM","GNEIS","GREIS","GRETZ","HAKEN","HASEL",
    "HAVEL","HEIDE","HELME","HERBE","HIRSE","HUMMEL","IMKER","INNEN","ISOLE","JACHT",
    "KARST","KEIME","KIEME","KNABE","KNAUL","KREBS","KUHLE","LAICH","L√ÑRM","LEHM",
    "LEINE","LENKE","LINDE","LITER","LODEN","M√ñHRE","MARDER","MATTE","MILCH","MOCKE",
    "M√ñWE","MULCH","MUFFE","MULM","MURKS","NACHTS","NIETE","N√úSSE","OCHSE","OTTER",
    "PACKE","PACHT","PFIRSICH","PFOTE","PIROL","PLUTO","POREN","PRIMEL","RAMPE","RAPS",
    "RASPE","RAUFE","RAUKE","REIZE","RINDE","RINNE","RIPPE","RISPE","R√ñHRE","RUHIG",
    "SALBE","SANDD","SCHERE","SCHILF","SCHIMM","SCHIRM","SCHLAG","SCHLUCHT","SCHROTT",
    "SEEL√ñWE","SENFE","SILBE","SKALA","SLANG","SMOLT","SPORE","STALL","STAMM","STAUB",
    "STAVE","STEIG","STELE","STIEL","STIFT","STIRN","STRAFE","STROM","ST√úCK","STUTE",
    "SZENE","TALER","TALG","TELON","THRON","TIGER","TINNE","TORF","TRICK","TRIEB",
    "TRINK","TROSSE","T√úPFE","TURBO","UFER","ULME","UMBRA","UMZUG","UNKE","URSEL",
    "VALVE","VENOM","VERSE","VISTA","VOLLE","WACKE","WALDE","WATZE","WEBEL","WEIDEN",
    "WENKE","WERFT","WETZE","WIDER","WILD","WINDE","WITWE","W√ñHLE","W√ñLKE","ZAHME",
    "ZEIGE","ZIRPE","ZOMBIE","ZOPFE","Z√úGLE","Z√ÑHNE","ABGAS","ABZUG","ACHSE","ADEPT",
    "AFFEN","ALAND","ALARM","ALBUM","ALGEN","ALTAN","AM√ñBE","AMPEL","ANBOT","ANKER",
    "ANMUT","ANTLITZ","ANVIL","ANZUG","APART","ARTIG","ASPIK","ASSAM","AUDIT","AUGE"
].filter(w => w.length === 5).map(w => w.toUpperCase());

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HILFSW√ñRTER ‚Äì alle g√ºltigen deutschen 5-Buchstaben W√∂rter (fallback aus words_de.js)
// Die echte Pr√ºfung l√§uft gegen window.words_de falls verf√ºgbar
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ Datum & Wort des Tages ‚îÄ‚îÄ
function getDayIndex() {
    const now = new Date();
    const epoch = new Date('2024-01-01T00:00:00Z');
    const diff = Math.floor((Date.UTC(now.getFullYear(), now.getMonth(), now.getDate()) - epoch.getTime()) / 86400000);
    return ((diff % DAILY_WORDS.length) + DAILY_WORDS.length) % DAILY_WORDS.length;
}

const TODAY_KEY = (() => {
    const d = new Date();
    return `wdt_${d.getFullYear()}_${d.getMonth()+1}_${d.getDate()}`;
})();

const ANSWER = DAILY_WORDS[getDayIndex()];

// ‚îÄ‚îÄ State ‚îÄ‚îÄ
let currentRow = 0;
let currentCol = 0;
let board = Array.from({length:6}, () => Array(5).fill(''));
let revealed = Array(6).fill(false);
let gameOver = false;
let won = false;

// ‚îÄ‚îÄ DOM refs ‚îÄ‚îÄ
const boardEl   = document.getElementById('board');
const keyboardEl= document.getElementById('keyboard');
const messageEl = document.getElementById('message');
const modalEl   = document.getElementById('modal');

// ‚îÄ‚îÄ Build Board ‚îÄ‚îÄ
function buildBoard() {
    boardEl.innerHTML = '';
    for (let r = 0; r < 6; r++) {
        const row = document.createElement('div');
        row.className = 'wdt-row';
        row.id = `row-${r}`;
        for (let c = 0; c < 5; c++) {
            const cell = document.createElement('div');
            cell.className = 'wdt-cell';
            cell.id = `cell-${r}-${c}`;
            row.appendChild(cell);
        }
        boardEl.appendChild(row);
    }
}

// ‚îÄ‚îÄ Build Keyboard ‚îÄ‚îÄ
const ROWS = [
    ['Q','W','E','R','T','Z','U','I','O','P','√ú'],
    ['A','S','D','F','G','H','J','K','L','√ñ','√Ñ'],
    ['ENTER','Y','X','C','V','B','N','M','‚å´']
];

function buildKeyboard() {
    keyboardEl.innerHTML = '';
    ROWS.forEach(row => {
        const rowEl = document.createElement('div');
        rowEl.className = 'wdt-key-row';
        row.forEach(k => {
            const btn = document.createElement('button');
            btn.className = 'wdt-key' + (k === 'ENTER' || k === '‚å´' ? ' wide' : '');
            btn.textContent = k;
            btn.dataset.key = k;
            btn.addEventListener('click', () => handleKey(k));
            rowEl.appendChild(btn);
        });
        keyboardEl.appendChild(rowEl);
    });
}

// ‚îÄ‚îÄ Key handling ‚îÄ‚îÄ
function handleKey(key) {
    if (gameOver) return;
    if (key === '‚å´' || key === 'BACKSPACE') {
        deleteLetter();
    } else if (key === 'ENTER') {
        submitGuess();
    } else if (/^[A-Z√Ñ√ñ√úa-z√§√∂√º]$/.test(key)) {
        addLetter(key.toUpperCase());
    }
}

document.addEventListener('keydown', e => {
    if (e.ctrlKey || e.metaKey || e.altKey) return;
    const key = e.key.toUpperCase();
    if (key === 'BACKSPACE') handleKey('BACKSPACE');
    else if (key === 'ENTER') handleKey('ENTER');
    else if (/^[A-Z√Ñ√ñ√ú]$/.test(key)) handleKey(key);
});

function addLetter(letter) {
    if (currentCol >= 5) return;
    board[currentRow][currentCol] = letter;
    const cell = document.getElementById(`cell-${currentRow}-${currentCol}`);
    cell.textContent = letter;
    cell.classList.add('filled');
    currentCol++;
}

function deleteLetter() {
    if (currentCol <= 0) return;
    currentCol--;
    board[currentRow][currentCol] = '';
    const cell = document.getElementById(`cell-${currentRow}-${currentCol}`);
    cell.textContent = '';
    cell.classList.remove('filled');
}

function submitGuess() {
    if (currentCol < 5) {
        showMessage('Bitte ein 5-Buchstaben-Wort eingeben!');
        shakeRow(currentRow);
        return;
    }
    const guess = board[currentRow].join('');

    // Word validation
    const valid = isValidWord(guess);
    if (!valid) {
        showMessage('Unbekanntes Wort!');
        shakeRow(currentRow);
        return;
    }

    revealRow(currentRow, guess, () => {
        if (guess === ANSWER) {
            won = true;
            gameOver = true;
            saveResult(true, currentRow + 1);
            setTimeout(() => showModal(true), 400);
        } else {
            currentRow++;
            currentCol = 0;
            if (currentRow >= 6) {
                gameOver = true;
                saveResult(false, 6);
                setTimeout(() => showModal(false), 400);
            }
        }
    });
}

function isValidWord(word) {
    // If words_de (the main word list) is loaded, use it
    if (typeof WORDS_DE !== 'undefined' && Array.isArray(WORDS_DE)) {
        return WORDS_DE.includes(word.toUpperCase()) || DAILY_WORDS.includes(word.toUpperCase());
    }
    // Fallback: accept any 5-letter sequence (loose mode)
    return word.length === 5;
}

// ‚îÄ‚îÄ Reveal row with flip animation ‚îÄ‚îÄ
function revealRow(row, guess, callback) {
    const result = scoreGuess(guess, ANSWER);
    for (let c = 0; c < 5; c++) {
        const cell = document.getElementById(`cell-${row}-${c}`);
        const delay = c * 200;
        setTimeout(() => {
            cell.classList.add('revealed');
            setTimeout(() => {
                cell.classList.remove('filled');
                cell.classList.add(result[c]);
                updateKey(guess[c], result[c]);
            }, 175);
        }, delay);
    }
    setTimeout(callback, 5 * 200 + 200);
}

function scoreGuess(guess, answer) {
    const result = Array(5).fill('absent');
    const ansArr = answer.split('');
    const guessArr = guess.split('');
    const used = Array(5).fill(false);

    // Pass 1: correct
    for (let i = 0; i < 5; i++) {
        if (guessArr[i] === ansArr[i]) {
            result[i] = 'correct';
            used[i] = true;
            guessArr[i] = null;
        }
    }
    // Pass 2: present
    for (let i = 0; i < 5; i++) {
        if (result[i] === 'correct') continue;
        for (let j = 0; j < 5; j++) {
            if (!used[j] && guessArr[i] === ansArr[j]) {
                result[i] = 'present';
                used[j] = true;
                break;
            }
        }
    }
    return result;
}

// ‚îÄ‚îÄ Key colors ‚îÄ‚îÄ
const keyColors = {};
const PRIORITY = { correct:3, present:2, absent:1 };

function updateKey(letter, state) {
    if ((PRIORITY[state]||0) > (PRIORITY[keyColors[letter]]||0)) {
        keyColors[letter] = state;
        document.querySelectorAll(`.wdt-key`).forEach(btn => {
            if (btn.dataset.key === letter) {
                btn.classList.remove('correct','present','absent');
                btn.classList.add(state);
            }
        });
    }
}

// ‚îÄ‚îÄ Message ‚îÄ‚îÄ
let msgTimeout;
function showMessage(txt, duration = 2000) {
    messageEl.textContent = txt;
    clearTimeout(msgTimeout);
    if (duration > 0) msgTimeout = setTimeout(() => messageEl.textContent = '', duration);
}

function shakeRow(row) {
    const rowEl = document.getElementById(`row-${row}`);
    rowEl.classList.add('wdt-shake');
    setTimeout(() => rowEl.classList.remove('wdt-shake'), 500);
}

// ‚îÄ‚îÄ Stats storage ‚îÄ‚îÄ
const STATS_KEY = 'wordify_wdt_stats';

function loadStats() {
    try { return JSON.parse(localStorage.getItem(STATS_KEY)) || {played:0,won:0,streak:0,maxStreak:0}; }
    catch { return {played:0,won:0,streak:0,maxStreak:0}; }
}

function saveResult(didWin, attempts) {
    // Prevent double-save
    if (localStorage.getItem(TODAY_KEY)) return;
    localStorage.setItem(TODAY_KEY, JSON.stringify({won:didWin, attempts}));

    const s = loadStats();
    s.played++;
    if (didWin) {
        s.won++;
        s.streak++;
        s.maxStreak = Math.max(s.maxStreak, s.streak);
    } else {
        s.streak = 0;
    }
    localStorage.setItem(STATS_KEY, JSON.stringify(s));
}

function winRate(s) {
    return s.played ? Math.round(s.won / s.played * 100) : 0;
}

// ‚îÄ‚îÄ Emoji result ‚îÄ‚îÄ
function buildEmojiResult() {
    let out = '';
    for (let r = 0; r <= (won ? currentRow : 5); r++) {
        if (!board[r][0]) break;
        const result = scoreGuess(board[r].join(''), ANSWER);
        out += result.map(s => s==='correct'?'üü©':s==='present'?'üü®':'‚¨ú').join('') + '\n';
    }
    return out.trim();
}

// ‚îÄ‚îÄ Modal ‚îÄ‚îÄ
function showModal(didWin) {
    const s = loadStats();
    const emojiResult = buildEmojiResult();
    const attempts = didWin ? currentRow + 1 : 'X';

    document.getElementById('modalIcon').textContent   = didWin ? 'üèÜ' : 'üòû';
    document.getElementById('modalTitle').textContent  = didWin ? 'Fantastisch!' : 'Schade!';
    document.getElementById('modalWord').innerHTML     = didWin
        ? `Erraten in <strong>${attempts}/6</strong> Versuchen`
        : `Das Wort war: <strong>${ANSWER}</strong>`;
    document.getElementById('modalStats').innerHTML = `
        <div class="wdt-modal-stat"><div class="val">${s.played}</div><div class="lbl">Gespielt</div></div>
        <div class="wdt-modal-stat"><div class="val">${winRate(s)}%</div><div class="lbl">Gewonnen</div></div>
        <div class="wdt-modal-stat"><div class="val">${s.streak}</div><div class="lbl">Streak</div></div>
        <div class="wdt-modal-stat"><div class="val">${s.maxStreak}</div><div class="lbl">Max</div></div>
    `;
    document.getElementById('modalResult').textContent = emojiResult;
    document.getElementById('modalNext').innerHTML = `N√§chstes Wort in <strong id="modalCountdown">${getCountdownStr()}</strong>`;

    const btns = document.getElementById('modalBtns');
    if (didWin) {
        btns.innerHTML = `
            <button class="wdt-btn wdt-btn-share" onclick="shareResult('${emojiResult.replace(/\n/g,'\\n')}','${attempts}')">üì§ Ergebnis teilen</button>
            <a href="/de/" class="wdt-btn wdt-btn-home" style="text-decoration:none;">üè† Zum Spiel</a>
        `;
    } else {
        btns.innerHTML = `
            <button class="wdt-btn wdt-btn-share" onclick="shareResult('${emojiResult.replace(/\n/g,'\\n')}','X')">üì§ Teilen</button>
            <a href="/de/" class="wdt-btn wdt-btn-home" style="text-decoration:none;">üè† Zum normalen Spiel</a>
        `;
    }

    modalEl.classList.add('active');

    // Update countdown in modal
    setInterval(() => {
        const el = document.getElementById('modalCountdown');
        if (el) el.textContent = getCountdownStr();
    }, 1000);
}

modalEl.addEventListener('click', e => {
    if (e.target === modalEl) modalEl.classList.remove('active');
});

// ‚îÄ‚îÄ Share ‚îÄ‚îÄ
function shareResult(emoji, attempts) {
    const d = new Date();
    const dateStr = `${d.getDate()}.${d.getMonth()+1}.${d.getFullYear()}`;
    const text = `Wordify ‚Äì Wort des Tages üóìÔ∏è\n${dateStr} ‚Äì ${attempts}/6\n\n${emoji.replace(/\\n/g,'\n')}\n\nwordify.pages.dev/de/wort-des-tages.html`;
    if (navigator.share) {
        navigator.share({ title: 'Wordify Wort des Tages', text });
    } else if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => showMessage('Kopiert! ‚úì', 2000));
    }
}

// ‚îÄ‚îÄ Countdown ‚îÄ‚îÄ
function getCountdownStr() {
    const now = new Date();
    const midnight = new Date(now);
    midnight.setHours(24, 0, 0, 0);
    const diff = midnight - now;
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

setInterval(() => {
    document.getElementById('countdown').textContent = getCountdownStr();
}, 1000);

// ‚îÄ‚îÄ Date display ‚îÄ‚îÄ
function showDate() {
    const d = new Date();
    const days = ['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'];
    const months = ['Jan','Feb','M√§r','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez'];
    document.getElementById('todayDate').textContent =
        `${days[d.getDay()]}, ${d.getDate()}. ${months[d.getMonth()]} ${d.getFullYear()}`;
}

// ‚îÄ‚îÄ Theme ‚îÄ‚îÄ
function toggleTheme() {
    const current = document.documentElement.getAttribute('data-theme');
    const next = current === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('wordifyTheme', next);
}

// ‚îÄ‚îÄ Already played today? ‚îÄ‚îÄ
function checkAlreadyPlayed() {
    const saved = localStorage.getItem(TODAY_KEY);
    if (!saved) return false;
    try {
        const data = JSON.parse(saved);
        // Replay the board visually (just show completed state)
        gameOver = true;
        won = data.won;
        showMessage(data.won ? '‚úì Heute bereits gespielt!' : 'Morgen wieder versuchen!', 0);
        return true;
    } catch { return false; }
}

// ‚îÄ‚îÄ Init ‚îÄ‚îÄ
(function init() {
    const savedTheme = localStorage.getItem('wordifyTheme');
    if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);

    buildBoard();
    buildKeyboard();
    showDate();
    document.getElementById('countdown').textContent = getCountdownStr();

    // If already played today, show a banner but still let them replay (read-only view)
    const played = localStorage.getItem(TODAY_KEY);
    if (played) {
        try {
            const data = JSON.parse(played);
            gameOver = false; // allow viewing but note it
            const banner = document.createElement('div');
            banner.className = 'wdt-played-banner';
            banner.innerHTML = `<p>Du hast das heutige Wort bereits gespielt.<br><strong>N√§chstes Wort um Mitternacht.</strong></p>`;
            boardEl.before(banner);
        } catch {}
    }
})();
</script>

<!-- Load German wordlist for validation -->
<script src="/words/words_de.js"></script>
</body>
</html>
